<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Catálogo de Produtos</title>

<style>
/* ===== RESET ===== */
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: "Segoe UI", Arial, sans-serif;
  background-color: #f9f9f9;
  color: #333;
  line-height: 1.6;
  overflow-x: hidden;
}

/* ===== HEADER ===== */
header {
  background-color: #fff;
  padding: 20px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  position: sticky;
  top: 0;
  z-index: 10;
  text-align: center;
}
header h1 {
  color: #007bff;
  font-size: 1.8rem;
  font-weight: 700;
  text-transform: uppercase;
}

/* ===== CATEGORIAS / PESQUISA ===== */
.categories {
  background: #fff;
  border-bottom: 1px solid #eee;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 10px;
  padding: 15px;
}
.category {
  background-color: #007bff;
  color: #fff;
  border: none;
  border-radius: 20px;
  padding: 8px 18px;
  cursor: pointer;
  transition: 0.3s;
}
.category:hover { background-color: #0056b3; }
.search-bar input {
  border: 1px solid #ccc;
  border-radius: 20px;
  padding: 8px 15px;
  width: 240px;
}

/* ===== CARROSSEL ===== */
.carousel {
  position: relative;
  width: 100%;
  overflow: hidden;
  background: #ddd;
}
.carousel-container {
  display: flex;
  transition: transform 0.8s ease;
}
.carousel-item {
  min-width: 100%;
  height: 380px;
}
.carousel-item img {
  width: 100%;
  height: 380px;
  object-fit: cover;
}
.carousel button {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background-color: rgba(0,0,0,0.5);
  color: #fff;
  border: none;
  border-radius: 50%;
  padding: 10px 15px;
  font-size: 20px;
  cursor: pointer;
  transition: 0.3s;
}
.carousel button:hover { background-color: rgba(0,0,0,0.8); }
.prev { left: 20px; }
.next { right: 20px; }

/* ===== CONTAINER PRINCIPAL ===== */
.main-container {
  max-width: 1200px;
  margin: 40px auto;
  padding: 0 20px;
}

/* ===== SEÇÃO ===== */
.section-title {
  text-align: center;
  color: #007bff;
  font-weight: 700;
  font-size: 1.6rem;
  margin-bottom: 20px;
  position: relative;
}
.section-title::after {
  content: "";
  display: block;
  width: 60px;
  height: 3px;
  background: #007bff;
  margin: 8px auto 0;
  border-radius: 2px;
}

/* ===== DESTAQUES ===== */
.highlight-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: 20px;
  margin-bottom: 40px;
}
.highlight-card img {
  width: 100%;
  height: 180px;
  object-fit: cover;
  border-radius: 8px;
  transition: transform 0.3s ease;
}
.highlight-card img:hover { transform: scale(1.03); }

/* ===== PRODUTOS ===== */
.product-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 25px;
}
.product-card {
  background-color: #fff;
  border-radius: 8px;
  padding: 15px;
  text-align: center;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  transition: 0.3s;
}
.product-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 4px 10px rgba(0,0,0,0.15);
}
.product-card img {
  width: 100%;
  height: 220px;
  object-fit: cover;
  border-radius: 6px;
  margin-bottom: 10px;
}
.product-card p {
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 5px;
}
.product-card span {
  color: #007bff;
  font-weight: bold;
  font-size: 0.95rem;
}
.product-card s {
  color: #888;
  font-weight: normal;
  margin-right: 5px;
}

/* ===== FOOTER ===== */
footer {
  text-align: center;
  padding: 20px;
  font-size: 0.9rem;
  color: #777;
  background: #fff;
  border-top: 1px solid #eee;
}
</style>
</head>

<body>

<header>
  <h1>Catálogo de Produtos</h1>
</header>

<section class="categories">
  <button class="category" id="btn-todos">Todos</button>
  <div class="search-bar">
    <input type="text" placeholder="Buscar produtos...">
  </div>
</section>

<!-- Carrossel de banners -->
<section class="carousel">
  <div class="carousel-container"></div>
  <button class="prev">&#10094;</button>
  <button class="next">&#10095;</button>
</section>

<main class="main-container">
  <h2 class="section-title">Destaques</h2>
  <div class="highlight-cards"></div>

  <h2 class="section-title">Produtos</h2>
  <div class="product-cards"></div>
</main>

<footer>
  © 2025 Catálogo de Produtos - Todos os direitos reservados.
</footer>

<script>
const spreadsheetId = '1_zUUbQCxJReQ9qcd-M9ADlogIl-d-Vo2volYSc6eQAY'; // substitua pelo ID da sua planilha

const urlProdutos = `https://docs.google.com/spreadsheets/d/${spreadsheetId}/gviz/tq?tqx=out:json&sheet=produtos`;
const urlBanners  = `https://docs.google.com/spreadsheets/d/${spreadsheetId}/gviz/tq?tqx=out:json&sheet=banners`;

let produtos = [];

/* === Carregar Produtos === */
fetch(urlProdutos)
  .then(res => res.text())
  .then(txt => {
    const jsonStr = txt.match(/(?<=\().*(?=\);)/s)[0];
    const json = JSON.parse(jsonStr);
    const cols = json.table.cols.map(c => c.label.trim().toLowerCase());
    const colIndex = {};
    cols.forEach((col, i) => colIndex[col] = i);

    produtos = json.table.rows.map(row => {
      const c = row.c;
      return {
        nome: c[colIndex['nome']]?.v || '',
        categoria: c[colIndex['categoria']]?.v || '',
        preco: c[colIndex['preço']]?.v || '',
        desconto: c[colIndex['desconto']]?.v || '',
        imagem: c[colIndex['imagem']]?.v || '',
        link: c[colIndex['link']]?.v || '#',
        ativo: c[colIndex['ativo']]?.v ?? true
      };
    }).filter(p => p.ativo);

    populaCategorias();
    renderProdutos(produtos);
  })
  .catch(console.error);

/* === Carregar Banners === */
fetch(urlBanners)
  .then(res => res.text())
  .then(txt => {
    const jsonStr = txt.match(/(?<=\().*(?=\);)/s)[0];
    const json = JSON.parse(jsonStr);
    const cols = json.table.cols.map(c => c.label.trim().toLowerCase());
    const colIndex = {};
    cols.forEach((col, i) => colIndex[col] = i);

    const dados = json.table.rows.map(row => {
      const c = row.c;
      return {
        tipo: c[colIndex['tipo']]?.v || '',
        imagem: c[colIndex['imagem']]?.v || '',
        link: c[colIndex['link']]?.v || '#',
        ativo: c[colIndex['ativo']]?.v ?? true
      };
    }).filter(d => d.ativo);

    const carrossel = dados.filter(d => d.tipo.toLowerCase() === 'carrossel');
    const destaques = dados.filter(d => d.tipo.toLowerCase() === 'destaque');

    renderCarrossel(carrossel);
    renderDestaques(destaques);
  })
  .catch(console.error);

/* === Renderizar Carrossel === */
function renderCarrossel(lista) {
  const container = document.querySelector('.carousel-container');
  container.innerHTML = '';
  lista.forEach(b => {
    const item = document.createElement('div');
    item.classList.add('carousel-item');
    item.innerHTML = `<a href="${b.link}" target="_blank"><img src="${b.imagem}" alt="banner"></a>`;
    container.appendChild(item);
  });

  // controles
  let currentSlide = 0;
  const slides = document.querySelectorAll('.carousel-item');
  const next = document.querySelector('.next');
  const prev = document.querySelector('.prev');

  function showSlide(i) {
    if (i >= slides.length) currentSlide = 0;
    else if (i < 0) currentSlide = slides.length - 1;
    else currentSlide = i;
    container.style.transform = `translateX(-${currentSlide * 100}%)`;
  }
  next.addEventListener('click', () => showSlide(currentSlide + 1));
  prev.addEventListener('click', () => showSlide(currentSlide - 1));
  setInterval(() => showSlide(currentSlide + 1), 5000);
}

/* === Renderizar Destaques === */
function renderDestaques(lista) {
  const container = document.querySelector('.highlight-cards');
  container.innerHTML = '';
  lista.forEach(d => {
    const div = document.createElement('div');
    div.classList.add('highlight-card');
    div.innerHTML = `<a href="${d.link}" target="_blank"><img src="${d.imagem}" alt="Destaque"></a>`;
    container.appendChild(div);
  });
}

/* === Renderizar Produtos === */
function renderProdutos(lista) {
  const container = document.querySelector('.product-cards');
  container.innerHTML = '';
  lista.forEach(p => {
    const div = document.createElement('div');
    div.classList.add('product-card');
    div.innerHTML = `
      <a href="${p.link}" target="_blank"><img src="${p.imagem}" alt="${p.nome}"></a>
      <p>${p.nome}</p>
      <span>${p.desconto ? `<s>R$ ${p.preco}</s> <strong style="color:#e74c3c;">R$ ${p.desconto}</strong>` : `R$ ${p.preco}`}</span>
    `;
    container.appendChild(div);
  });
}

/* === Categorias === */
function populaCategorias() {
  const container = document.querySelector('.categories');
  const searchBar = document.querySelector('.search-bar');
  const btnTodos = document.getElementById('btn-todos');
  container.innerHTML = '';
  container.appendChild(btnTodos);
  const categorias = [...new Set(produtos.map(p => p.categoria).filter(Boolean))];
  categorias.forEach(cat => {
    const btn = document.createElement('button');
    btn.classList.add('category');
    btn.textContent = cat;
    btn.onclick = () => renderProdutos(produtos.filter(p => p.categoria === cat));
    container.appendChild(btn);
  });
  container.appendChild(searchBar);
  btnTodos.onclick = () => renderProdutos(produtos);
}

/* === Pesquisa === */
document.querySelector('.search-bar input').addEventListener('input', e => {
  const termo = e.target.value.toLowerCase();
  const filtrados = produtos.filter(p => p.nome.toLowerCase().includes(termo));
  renderProdutos(filtrados);
});
</script>

</body>
</html>
